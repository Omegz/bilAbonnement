<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Dataregistrering - Opret lejeaftale</title>
  <style>

    body {
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      margin: 0;
      padding: 40px;
      min-height: 100vh;

    }

    h1 {
      font-size: 30px;
      margin-bottom: 26px;
      letter-spacing: 0.4px;
    }

    .card {
      max-width: 760px;
      background: var(--card-bg);
      color: var(--text);
      padding: 30px;
      border-radius: 18px;
      border: 1px solid var(--border);
      box-shadow:
              0 20px 40px rgba(0,0,0,0.25),
              0 0 0 1px rgba(255,255,255,0.4) inset;
      animation: floatIn 0.6s ease-out;
    }

    @keyframes floatIn {
      from {
        opacity: 0;
        transform: translateY(16px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .row {
      display: flex;
      gap: 18px;
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      font-size: 14px;
    }

    input,
    select {
      width: 100%;
      padding: 11px 13px;
      font-size: 14px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: linear-gradient(#fff, #f9fafb);
      transition: all 0.25s ease;
    }

    input:hover,
    select:hover {
      border-color: var(--primary);
    }

    input:focus,
    select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow:
              0 0 0 3px var(--primary-glow),
              0 4px 12px rgba(59,130,246,0.25);
    }

    button {
      margin-top: 18px;
      padding: 12px 22px;
      font-size: 14px;
      font-weight: 600;
      color: #fff;
      background: linear-gradient(135deg, #3b82f6, #2563eb);
      border: none;
      border-radius: 12px;
      cursor: pointer;
      box-shadow:
              0 10px 20px rgba(37,99,235,0.35),
              0 0 0 0 rgba(59,130,246,0.6);
      transition: all 0.25s ease;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow:
              0 14px 28px rgba(37,99,235,0.45),
              0 0 0 4px rgba(59,130,246,0.25);
    }

    button:active {
      transform: translateY(1px);
    }

    .fejl {
      background: linear-gradient(135deg, #fee2e2, #fecaca);
      color: var(--error);
      padding: 14px 16px;
      border-radius: 12px;
      margin-bottom: 18px;
      font-size: 14px;
      border: 1px solid #fca5a5;
    }

    .hint {
      font-size: 12px;
      color: var(--muted);
      margin-top: 6px;
    }

    .hidden {
      display: none;
    }

    /* ===== NAVBAR FIX TIL DARK BACKGROUND ===== */

    .navbar {
      background: linear-gradient(180deg, #064e3b, #022c22);
      border-bottom: 1px solid rgba(255,255,255,0.12);
      padding: 14px 0;
      margin-bottom: 30px;
    }

    .nav-container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* Logo / brand */
    .navbar .brand {
      color: #ecfdf5;
      font-size: 20px;
      font-weight: 700;
      text-decoration: none;
    }

    /* Link container */
    .nav-links {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }

    /* Navbar links */
    .nav-links a {
      color: #d1fae5;
      text-decoration: none;
      font-size: 14px;
      padding: 6px 10px;
      border-radius: 6px;
      transition: background 0.2s ease, color 0.2s ease;
    }

    /* Hover */
    .nav-links a:hover {
      background: rgba(255,255,255,0.12);
      color: #ffffff;
    }

    /* Logout lidt tydeligere */
    .nav-links a:last-child {
      color: #fca5a5;
    }

    .nav-links a:last-child:hover {
      background: rgba(239,68,68,0.2);
      color: #ffffff;
    }

  </style>


</head>
<body>
<div th:replace="fragments/navbar :: navbar"></div>

<h1>Dataregistrering: Opret lejeaftale</h1>

<div class="card">
  <div th:if="${fejl}" class="fejl" th:text="${fejl}"></div>

  <form th:action="@{/data/lejeaftale/opret}" th:object="${form}" method="post">

    <div class="row">
      <div class="field">
        <label for="kundeId">Kunde</label>
        <select id="kundeId" th:field="*{kundeId}" required>
          <option value="">-- vælg kunde --</option>
          <option th:each="k : ${kunder}"
                  th:value="${k.id}"
                  th:text="${k.navn}"></option>
        </select>
        <div class="hint">Kunder hentes fra databasen (oprettes under /kunder).</div>
      </div>
    </div>

    <div class="row">
      <div class="field">
        <label for="bilId">Bil</label>
        <select id="bilId" th:field="*{bilId}" required>
          <option value="">-- vælg bil --</option>
          <option th:each="b : ${biler}" th:value="${b.id}" th:text="${b.navn}"></option>
        </select>
      </div>
      <div class="field">
        <label for="maanedligPris">Månedlig pris (DKK)</label>
        <input id="maanedligPris" type="number" step="0.01" th:field="*{maanedligPris}" required>
      </div>
    </div>

    <div class="row">
      <div class="field">
        <label for="startdato">Startdato</label>
        <input id="startdato" type="date" th:field="*{startdato}" th:attr="min=${today}" required>
        <div class="hint">Startdato kan kun være i dag eller frem i tiden.</div>
      </div>
      <div class="field">
        <label for="slutdato">Slutdato (valgfri)</label>
        <input id="slutdato" type="date" th:field="*{slutdato}">
        <div class="hint">Hvis tom beregnes slutdato automatisk ud fra kontrakten.</div>
      </div>
    </div>

    <div class="row">
      <div class="field">
        <label for="kontraktType">Kontrakttype</label>
        <select id="kontraktType" th:field="*{kontraktType}">
          <option value="LIMITED">Limited (150 dage)</option>
          <option value="UNLIMITED">Unlimited (3–36 måneder)</option>
        </select>
      </div>

      <div class="field">
        <label for="kontraktVarighedDage">Varighed (dage) – kun Unlimited</label>
        <input id="kontraktVarighedDage" type="number" th:field="*{kontraktVarighedDage}" placeholder="fx 90, 180, 365">
        <div class="hint">Unlimited: 90–1080 dage. Limited er fast 150 dage.</div>
      </div>
    </div>

    <div class="row">
      <div class="field">
        <label for="udleveringsstedType">Udleveringssted</label>
        <select id="udleveringsstedType" th:field="*{udleveringsstedType}">
          <option value="BILABONNEMENT">Bilabonnement</option>
          <option value="FDM">FDM</option>
          <option value="DS">DS-forhandler</option>
        </select>
      </div>

      <div class="field">
        <label for="leveringsform">Leveringsform</label>
        <select id="leveringsform" th:field="*{leveringsform}">
          <option value="AFHENTNING">Afhentning</option>
          <option value="LEVERING">Levering</option>
        </select>
      </div>
    </div>

    <div id="adresseWrap" class="row hidden">
      <div class="field">
        <label for="leveringsadresse">Leveringsadresse</label>
        <input id="leveringsadresse" type="text" th:field="*{leveringsadresse}" placeholder="Vejnavn 1, 2100 København Ø">
        <div class="hint">Kun nødvendig når leveringsform er LEVERING.</div>
      </div>
    </div>

    <hr style="margin: 16px 0;">

    <div class="row">
      <div class="field">
        <label for="medarbejderNavn">Medarbejder-navn</label>
        <input id="medarbejderNavn" type="text" th:field="*{medarbejderNavn}" required>
      </div>
      <div class="field">
        <label for="medarbejderPassword">Medarbejder-password</label>
        <input id="medarbejderPassword" type="password" th:field="*{medarbejderPassword}" required>
      </div>
    </div>

    <div class="hint">MVP: ekstra kontrol ved submit. Kun DATAREGISTRERING må oprette lejeaftaler.</div>

    <div style="margin-top: 14px;">
      <button type="submit">Opret lejeaftale</button>
    </div>

  </form>
</div>

<script>
  const leveringsform = document.getElementById('leveringsform');
  const adresseWrap = document.getElementById('adresseWrap');
  const adresseInput = document.getElementById('leveringsadresse');

  function toggleAdresse() {
    const isLevering = leveringsform.value === 'LEVERING';
    adresseWrap.classList.toggle('hidden', !isLevering);
    adresseInput.required = isLevering;
  }

  leveringsform.addEventListener('change', toggleAdresse);
  toggleAdresse(); // init
</script>

</body>
</html>
